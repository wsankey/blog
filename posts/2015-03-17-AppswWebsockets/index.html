<!DOCtype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Will Sankey | Data and code</title>
   <script src="//use.typekit.net/puo2mkm.js"></script>
	<script>try{Typekit.load({ async: true });}catch(e){}</script>
    <link rel=stylesheet type=text/css href="/static/css/bootstrap.min.css"/>
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <link rel=stylesheet type=text/css href="/static/css/main.css"/>
    <meta name="viewport" content="width=device-width">


<link rel="apple-touch-icon" sizes="57x57" href="/static/media/apple-icon-57x57.png"/>
<link rel="apple-touch-icon" sizes="60x60" href="/static/media/apple-icon-60x60.png"/>
<link rel="apple-touch-icon" sizes="72x72" href="/static/media/apple-icon-72x72.png"/>
<link rel="apple-touch-icon" sizes="76x76" href="/static/media/apple-icon-76x76.png"/>
<link rel="apple-touch-icon" sizes="114x114" href="/static/media/apple-icon-114x114.png"/>
<link rel="apple-touch-icon" sizes="120x120" href="/static/media/apple-icon-120x120.png"/>
<link rel="apple-touch-icon" sizes="144x144" href="/static/media/apple-icon-144x144.png"/>
<link rel="apple-touch-icon" sizes="152x152" href="/static/media/apple-icon-152x152.png"/>
<link rel="apple-touch-icon" sizes="180x180" href="/static/media/apple-icon-180x180.png"/>
<link rel="icon" type="image/png" sizes="192x192"  href="/static/media/android-icon-192x192.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="/static/media/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="96x96" href="/static/media/favicon-96x96.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="/static/media/favicon-16x16.png"/>
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">



</head>
<body>
<div class="container">
	<div class="row">
		<div class="col-sm-12">
        <h1><a class="brandcolor" href="/">Will Sankey</a>
        <small>
        <span class="namegroup">
        <ul id="namelist">
          <li id="list"><a class="brandcolor2" href="/aboutme/">[About,</a></li>
          <li id="list"><a class="brandcolor2" href="/posts/">Blog,</a></li>
          <li id="list"><a  class="brandcolor2"href="/projects/">Etc.]</a></h3></li>
        </ul>
        </span>
        </small>
        </h1>
    </div>
  </div>

  <div class="row" style="overflow: hidden">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Toplevel -->
    <ins class="adsbygoogle"
         style="display:inline-block;width:728px;height:90px"
         data-ad-client="ca-pub-1891842734562267"
         data-ad-slot="9898481805"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    </div>
    <div class="col-sm-2"></div>
  </div>



<div class="container">
	<div class="row">
		<div  class="col-xs-12 card" style="margin-bottom: 4em;">
					<a href="/posts/"></a>
			<h2>DC Django-district Meetup - Python Websockets</h2>
			<p class="date">2015-03-17</p>
			<p>The following are my notes from the March DC Django-district meetup on websockets with python, presented by Matt Makai (@mattmakai) of Twilio. Matt Makai also maintains <a href="http://www.fullstackpython.com/"><strong>Full Stack Python</strong></a>.</p>
<p><em>Note: These notes might be incomplete.</em></p>
<h3><a href="http://www.mattmakai.com/presentations/2015-async-web-apps-django-district.html#/">Asynchronous Python Web Apps with WebSockets</a></h3>
<p>To summarize, the core idea for the talk was:</p>
<p><em>If you want full communication between the browser and the server this
is how to do it without resorting to Node.js</em></p>
<p>The idea is to get a WSGI server to invoke the python code you've
written. WSGI is a blocking interface, meaning that every time a request
arrives the server will process the request and be done. In the context
of the historical world wide web this made sense.</p>
<h3>The old days</h3>
<p>In the beginning, the web browser communicates with the web server. The server would
simple return back static files and that's ok <em>if you only have static
files.</em></p>
<p>But if you want dynamic applications you need something more - the WSGI
server interface. When you run a Flask or Django application the web
server, WSGI, acts as a proxy - it runs some python and returns back
something: HTML, JSON, etc. </p>
<p>Around 2005 AJAX was introduced, giving us richer applications. In this
regime we are able to retrieve data from the backend: <a href="http://en.wikipedia.org/wiki/Push_technology">Long Polling.</a> E.g. Having Facebook pdates coming in to your feed. However, this was problematic and the web community responded with:</p>
<h3>Async</h3>
<p>Async can keep the communication open between the client and the server.
Before we had Long Polling with AJAX (a constant checking for updates).
But we wanted a way of passing data between server and browser. Async
keeps that connection open.</p>
<p>There are differetn ways of doing this - we've usually resorted to
Node.js but we can use python solutions, like <strong>gevent</strong></p>
<h3>Live Coding Example</h3>
<p><strong>See python-websockets-example from Github</strong></p>
<p>The libraries being used:</p>
<ul>
<li>Flask</li>
<li>Flask-socketio (written by person who wrote O'Reilly Flask book)</li>
<li>Redis</li>
</ul>
<p>Create an empty repository, install those libraries, and then</p>
<p>pip freeze </p>
<p>the dependencies </p>
<p>The python code for the older style of application:</p>
<p>import redis
from flask import Flask, render_template</p>
<p>app = Flask(<strong>name</strong>)
db = redis.StrictRedis('localhost', 6379, 0)</p>
<p>@app.route('/')
def main():
  c = db.incr('user_count')
  return render_template('main.html', counter=c)</p>
<p>if <strong>name</strong> == "<strong>main</strong>":
  app.run(debug=True)</p>
<p>And then we code custom to render our python script (<em><a href="https://github.com/makaimc/python-websockets-example">from here on out
you should refer to Matt's repository for the code, I won't copy and
paste it.</a></em>)</p>
<p><a href="https://github.com/makaimc/python-websockets-example/blob/master/templates/main.html">The HTML template.</a></p>
<p>Ok, so the example works but we can improve it using Async libraries.</p>
<h2>Let's do it with Socketio</h2>
<p>Lot of code but essentially we submit the form as SocketIo and not HTML.</p>
<p>The server is getting information and serving it out, but now we can use
socketio.emit to have the server send it out to all other web browsers
connecting.</p>
<p>Matt is presenting at this year's <a href="https://us.pycon.org/2015/schedule/">pycon in Montreal</a> and I'll be
sure to post his talk here when it's complete.</p>
		</div>
	</div>
</div>

    </div>
  </div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67546347-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>